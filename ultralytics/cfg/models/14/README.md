# YOLO-14


## 设计思路

在yolo11的基础上进行改进的方法。

### 优点
1. 可以继承`yolo11`的优点，不会有性能gap

### 缺点
1. 通道数不方便调整
2. 如果`yolo11`设计不够好，没有办法改进


## 目前设计结果

1. `yolo14`
   - 使用`convnext`替换了所有的`bottleneck`
   - 调整了`c3k2(c3k=True)`时的`convnext`通道数
   - 各层的参数量计算量基本不变
   - 用于验证`convnext`的有效性

   实验结果表明，yolo14有非常明显的性能提升，速度有微小提升。结论如下：
   - 模型宽度对精度非常重要。`convnext`可以显著提升模块的宽度，从而提升性能
   - 小物体精度提升小，也是因为小物体不能显著提升宽度

2. `yolo141`
   - 删除`c3k2`结构，使用了一个新的结构`c3nx`，该结构保持了模型的深度基本不变，删除了一部分1x1的参数，提升了各层的宽度
   - 改变了上采样模块以提升位置敏感性。

3. `yolo142`

   `yolo141`的参数量对齐得不是很好。在`yolo14`基础上，使用了混合`c3nx`和`c3nx2`的结构，提升高分辨率时的通道宽度
   - 所有`c3k=False`的`c3k2`替换为`c3nx`

4. `yolo145`

   在 `yolo142` 的基础上改进了上采样模块

   - 将 `nearest` 上采样替换为 `ConvTranspose` 模块。`nearest` 衔接 `Conv1x1` 会造成大量重复计算，不如使用 `ConvTranspose` 增强上采样的特征。
   - `ConvTranspose` 后面不再需要衔接 `Conv1x1` 计算，所以可以把 `Concat` 操作修改为 `Add` 操作。因此实现了一个新模块 `UpsampleMerge`，修改后模型的计算量完全不变，参数量略有增加。

5. `yolo146`

   `SPPF` 模块的有效性存疑。原因如下：

   - `SPPF` 通过4层 `maxpooling_5x5` 实现了一个相对大范围的感受野。但是同类型的 `Attention` 等结构可以实现类似的效果，还具有更强的动态性和非线性。例如 `yolo12` 就使用了统一的 `Attention` 模块，删除了 `SPPF`。
   - `maxpooling` 会破坏特征间的位置关系，对于密集预测任务可能有负面影响。模型并不知道当前输出结果是从哪个位置获得的。也没有使用 `unpooling` 等任务还原低层次架构。
   - 现在视觉任务中几乎没有使用 `maxpooling` 的场景。除了在一些 anti-aliasing 的研究中，`maxpooling` 会被用于构建 shift-invariant 模块。但是 shift-invariance 本来就是和密集预测任务冲突的。

   综上所述，`SPPF` 模块必须被取缔。最简单的方法是在 `C2PSA` 模块中增加一个 `PSABlock`。修改后模型的参数量计算量几乎不变，**但速度可能会变慢**。`C2PSA` 未必是最优解，`A2C2f` 可能也不错，后续如果有资源值得尝试。


## 实验结果
| Model | mAP<sub>50-95</sub> | AP<sub>small</sub> | AP<sub>medium</sub> | AP<sub>large</sub> | FPS<br><sup>3090 ONNX</sup>  | params<br><sup>(M)</sup> |FLOPs<br><sup>(B) |
| -------- | ----- | ----- | ----- | ----- | --- | ----- | ---- |
| yolo11n  | 0.390 | 0.190 | 0.432 | 0.565 | 220 | 2.616 | 6.48 |
| yolo14n  | 0.399 | 0.191 | 0.439 | 0.586 | 225 | 2.613 | 6.52 |
| yolo142n | 0.401 | 0.203 | 0.443 | 0.578 | 225 | 2.620 | 6.49 |
| yolo145n |       |       |       |       |     | 2.743 | 6.49 |
| yolo146n |       |       |       |       |     | 2.695 | 6.45 |
